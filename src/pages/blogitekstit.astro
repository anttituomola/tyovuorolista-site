---
import { getLocaleFromAstro } from '../utils/translations'
import BlogPostCard from '../components/common/BlogPostCard.astro'
import Layout from '../layouts/Layout.astro'

const locale = getLocaleFromAstro(Astro)

// Redirect non-Finnish users or show empty state
let allPosts = []
let sortedPosts = []

if (locale === 'fi') {
    allPosts = await Astro.glob('../pages/posts/*.md')
    sortedPosts = allPosts.sort((a, b) => a.frontmatter.pubDate < b.frontmatter.pubDate ? 1 : -1)
} else {
    // Redirect to home page for non-Finnish locales
    return Astro.redirect(locale === 'en' ? '/en/' : '/sv/')
}
---

<Layout>
    <div class="wrapper">
        <h1>Tekstejä ravintolan työvuorosuunnittelusta</h1>
        <div class="blogitekstit">
            {sortedPosts.map((post) => <BlogPostCard post={post} />)}
        </div>
    </div>
</Layout>

<style>
    .blogitekstit {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }
    @media (max-width: 1000px) {
        .blogitekstit {
            grid-template-columns: 1fr;
        }
    }
</style>
